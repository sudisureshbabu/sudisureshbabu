{
	"name": "4_create_external_tables",
	"properties": {
		"folder": {
			"name": "nyc_taxi/ldw"
		},
		"content": {
			"query": "use nyc_taxi_ldw;\n\n--- create external table using csv file format\n\nSELECT *FROM sys.external_tables;\nIF OBJECT_ID ( 'bronze.taxi_zone') is NOT NULL\n    drop EXTERNAL TABLE bronze.taxi_zone\n    -- creating external table taxi_zone\n    CREATE EXTERNAL TABLE bronze.taxi_zone\n        (   location_id SMALLINT ,\n            borough VARCHAR(15) ,\n            zone VARCHAR(50) ,\n            service_zone VARCHAR(15) )  \n        WITH (\n            LOCATION = 'raw/taxi_zone.csv',  \n            DATA_SOURCE = nyc_taxi_src,  \n            FILE_FORMAT = csv_file_format  \n        )\nGO\n\n\nselect *from bronze.taxi_zone\nGO\n\n--- create external table using csv file format\n\nIF OBJECT_ID ( 'bronze.calendar') is NOT NULL\n    drop EXTERNAL TABLE bronze.calendar\n    -- creating external table calendar\n    CREATE EXTERNAL TABLE bronze.calendar\n        (       date_key INT,\n                date DATE,\n                year SMALLINT,\n                month TINYINT,\n                day TINYINT,\n                day_name VARCHAR(10),\n                day_of_year SMALLINT,\n                week_of_month TINYINT,\n                week_of_year TINYINT,\n                month_name VARCHAR(10),\n                year_month INT,\n                year_week INT\n    )  \n        WITH (\n            LOCATION = 'raw/calendar.csv',  \n            DATA_SOURCE = nyc_taxi_src,  \n            FILE_FORMAT = csv_file_format  \n        )\nGO\n\nselect *from bronze.calendar\nGO\n\n--- create external table using CSV file format\n\nIF OBJECT_ID ( 'bronze.vendor') is NOT NULL\n    drop EXTERNAL TABLE bronze.vendor\n    -- creating external table vendor\n    CREATE EXTERNAL TABLE bronze.vendor\n        (       vendor_id TINYINT,\n                vendor_name VARCHAR(50)\n        )  \n        WITH (\n            LOCATION = 'raw/vendor.csv',  \n            DATA_SOURCE = nyc_taxi_src,  \n            FILE_FORMAT = csv_file_format  \n        )\nGO\n\nselect *from bronze.vendor\nGO\n\n--- create external table using TSV file format\n\nIF OBJECT_ID ( 'bronze.trip_type') is NOT NULL\n    drop EXTERNAL TABLE bronze.trip_type\n    -- creating external table vendor\n    CREATE EXTERNAL TABLE bronze.trip_type\n        (       trip_type TINYINT,\n                trip_type_desc VARCHAR(50)\n        )  \n        WITH (\n            LOCATION = 'raw/trip_type.tsv',  \n            DATA_SOURCE = nyc_taxi_src,  \n            FILE_FORMAT = tsv_file_format  \n        )\nGO\n\nselect *from bronze.trip_type\nGO\n\n--- create external table using csv file format and with multiple partitions\n\nIF OBJECT_ID ( 'bronze.trip_data_green_csv') is NOT NULL\n    drop EXTERNAL TABLE bronze.trip_data_green_csv\n    -- creating external table vendor\n    CREATE EXTERNAL TABLE bronze.trip_data_green_csv\n        (        VendorID\t\t\t\t int,\n                lpep_pickup_datetime     datetime2(7),\n                lpep_dropoff_datetime    datetime2(7),\n                store_and_fwd_flag       varchar(1),\n                RatecodeID               int,\n                PULocationID             int,\n                DOLocationID             int,\n                passenger_count          int,\n                trip_distance            float,\n                fare_amount              float,\n                extra                    float,\n                mta_tax                  float,\n                tip_amount               float,\n                tolls_amount             float,\n                ehail_fee                int,\n                improvement_surcharge    float,\n                total_amount             float,\n                payment_type             int,\n                trip_type                int,\n                congestion_surcharge     float\n        )  \n        WITH (\n            LOCATION = 'raw/trip_data_green_csv/**',  \n            DATA_SOURCE = nyc_taxi_src,  \n            FILE_FORMAT = csv_file_format  \n        )\nGO\n\nselect  TOP 100 \n*from bronze.trip_data_green_csv\nGO\n\n\n--- create external table using parquet file format\n\nIF OBJECT_ID ( 'bronze.trip_data_green_paruet') is NOT NULL\n    drop EXTERNAL TABLE bronze.trip_data_green_paruet\n    -- creating external table vendor\n    CREATE EXTERNAL TABLE bronze.trip_data_green_paruet\n        (        VendorID\t\t\t\t int,\n                lpep_pickup_datetime     datetime2(7),\n                lpep_dropoff_datetime    datetime2(7),\n                store_and_fwd_flag       varchar(1),\n                RatecodeID               int,\n                PULocationID             int,\n                DOLocationID             int,\n                passenger_count          int,\n                trip_distance            float,\n                fare_amount              float,\n                extra                    float,\n                mta_tax                  float,\n                tip_amount               float,\n                tolls_amount             float,\n                ehail_fee                int,\n                improvement_surcharge    float,\n                total_amount             float,\n                payment_type             int,\n                trip_type                int,\n                congestion_surcharge     float\n        )  \n        WITH (\n            LOCATION = 'raw/trip_data_green_parquet/**',  \n            DATA_SOURCE = nyc_taxi_src,  \n            FILE_FORMAT = parquet_file_format  \n        )\nGO\n\nselect  TOP 100 \n*from bronze.trip_data_green_paruet\nGO\n\n\n--- create external table using delta file format\n\nIF OBJECT_ID ( 'bronze.trip_data_green_delta') is NOT NULL\n    drop EXTERNAL TABLE bronze.trip_data_green_delta\n    -- creating external table vendor\n    CREATE EXTERNAL TABLE bronze.trip_data_green_delta\n        (        VendorID\t\t\t\t int,\n                lpep_pickup_datetime     datetime2(7),\n                lpep_dropoff_datetime    datetime2(7),\n                store_and_fwd_flag       varchar(1),\n                RatecodeID               int,\n                PULocationID             int,\n                DOLocationID             int,\n                passenger_count          int,\n                trip_distance            float,\n                fare_amount              float,\n                extra                    float,\n                mta_tax                  float,\n                tip_amount               float,\n                tolls_amount             float,\n                ehail_fee                int,\n                improvement_surcharge    float,\n                total_amount             float,\n                payment_type             int,\n                trip_type                int,\n                congestion_surcharge     float\n        )  \n        WITH ( LOCATION = 'raw/trip_data_green_delta',  \n               DATA_SOURCE = nyc_taxi_src,  \n               FILE_FORMAT = delta_file_format  \n        )\nGO\n\nselect  TOP 100 \n*from bronze.trip_data_green_delta\nGO\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "nyc_taxi_ldw",
				"poolName": "Built-in"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}